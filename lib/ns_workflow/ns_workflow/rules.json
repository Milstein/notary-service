[
  {
    "rule": "MATCH (s {GraphID: $graphId, Type: \"Start\"}) RETURN count(*)=1",
    "msg": "There must be a single Start node."
  },
  {
    "rule": "MATCH (s {GraphID: $graphId, Type: \"Stop\"}) RETURN count(*)=1",
    "msg": "There must be a single Stop node."
  },
  {
    "rule": "MATCH (s {GraphID: $graphId}), p= (s) -[*]-> (s) RETURN size(collect(p))=0",
    "msg": "Workflow graph must not contain cycles."
  },
  {
    "rule": "MATCH (s {GraphID: $graphId}), (d {GraphID: $graphId}), (e {GraphID: $graphId}) WHERE s.Type=\"Start\" AND NOT d.Type=\"Start\" and NOT e.Type=\"Start\" WITH s, d, count(e) AS TotalDest MATCH p= (s) -[*]-> (d) WITH d, count(p) AS cp, TotalDest RETURN TotalDest=size(collect(cp))",
    "msg": "Any node must be reachable from the Start node."
  },
  {
    "rule": "MATCH (s {GraphID: $graphId}), (d {GraphID: $graphId}), (e {GraphID: $graphId}) WHERE NOT s.Type=\"Stop\" AND d.Type=\"Stop\" and NOT e.Type=\"Stop\" WITH s, d, count(e) AS TotalSrc MATCH p= (s) -[*]-> (d) WITH s, count(p) AS cp, TotalSrc RETURN TotalSrc=size(collect(cp))",
    "msg": "Stop node must be reachable from any node."
  },
  {
    "rule": "MATCH(n {GraphID: $graphId}) RETURN ALL(r IN collect(n) WHERE exists(r.Type) AND exists(r.Role) AND exists(r.ID) AND exists(r.SAFEType))",
    "msg": "Type, Role, ID, SAFEType properties must be present on each node"
  },
  {
    "rule": "MATCH (n {GraphID: $graphId}) -[r]-> (m {GraphID: $graphId}) RETURN ALL(r IN collect(r) WHERE exists(r.ParameterValue))",
    "msg": "All relationships must have ParameterValue properties"
  },
  {
    "rule": "MATCH(n {GraphID: $graphId}) -[r:isPrerequisiteFor]-> (m {GraphID: $graphId}) with n, count(DISTINCT r.ParameterValue) AS pc, count(r) AS c WHERE pc > 1 AND c <> pc RETURN count(n) = 0",
    "msg": "Branches of conditional nodes must have distinct values"
  },
  {
    "rule": "MATCH (n {GraphID: $graphId}), (m {GraphID: $graphId}) WHERE n.ID=m.ID AND NOT id(n)=id(m) RETURN count(n) = 0",
    "msg": "All node IDs must be distinct."
  },
  {
    "rule": "MATCH (n {GraphID: $graphId}) RETURN ALL(m IN collect(n) WHERE ALL(r IN split(m.Role, ',') WHERE r IN [\"None\", \"STAFF\", \"DP\", \"INP\", \"PI\", \"IG\"]))",
    "msg": "Node roles should be None, STAFF, DP, INP, IG, or PI."
  },
  {
    "rule": "MATCH (n {GraphID: $graphId}) RETURN ALL(r IN collect(n) WHERE r.Type IN [\"Start\", \"Stop\", \"AssertionItem\"])",
    "msg": "Node types must be Start, Stop and AssertionItem"
  }
]
